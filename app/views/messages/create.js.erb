function appendNewMessage(message) {
  const postItem = document.querySelector('[data-post-id="<%= @post.id %>"]');
  const conv = postItem.nextElementSibling
  var lastMessage = postItem.nextElementSibling.lastElementChild

  lastMessage.insertAdjacentHTML('afterend', message);
  document.querySelector("#message_body").value = "";
  if (conv.childElementCount > 4) {
    conv.style.height = `calc(${conv.offsetHeight + lastMessage.offsetHeight}px + 1.5rem)`
    window.scroll(0, conv.offsetHeight + conv.offsetTop  - window.innerHeight + 57)
  }

}

appendNewMessage(`<%= render 'shared/message', message: @message %>`);
